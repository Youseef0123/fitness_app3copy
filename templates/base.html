<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}AI Fitness Trainer{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="manifest" href="/static/manifest.json">
    <meta name="theme-color" content="#0d6efd">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    {% block head %}{% endblock %}
</head>
<body>
    {% block content %}{% endblock %}

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    {% block scripts %}{% endblock %}
    
    <!-- Performance monitoring script -->
    <script>
        // Report performance metrics if the browser supports it
        if (window.performance && window.performance.mark) {
            // Mark when page starts loading
            window.performance.mark('pageStart');
            
            // On load, measure time to first render
            window.addEventListener('load', () => {
                window.performance.mark('pageLoaded');
                window.performance.measure('pageLoadTime', 'pageStart', 'pageLoaded');
                
                // Log performance data
                const pageLoadMetric = window.performance.getEntriesByName('pageLoadTime')[0];
                console.log(`Page load time: ${pageLoadMetric.duration.toFixed(2)}ms`);
                
                // Clear marks and measures to avoid memory leaks
                window.performance.clearMarks();
                window.performance.clearMeasures();
            });
        }
        
        // Check for service worker support
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/static/service-worker.js')
                    .then(registration => {
                        console.log('ServiceWorker registered with scope:', registration.scope);
                    })
                    .catch(error => {
                        console.log('ServiceWorker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>